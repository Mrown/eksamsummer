<html>
    <head>
        <title>Social Network</title>
        <link rel="stylesheet" href="/public/css/main.min.css">
        <link rel="stylesheet" href="/public/css/style.css">
        <link rel="stylesheet" href="/public/css/color.css">
        <link rel="stylesheet" href="/public/css/responsive.css">
    </head>

    <!-- Form til Signup -->

<body>
    <div class="theme-layout">
        <div class="container-fluid pdng0">
            <div class="row merged">
                <div class="offset-md-3 col-md-6">
                    <div class="login-reg-bg">
                        <div class="log-reg-area sign">
                        <h2 class="log-title">Register</h2>

                        <form onsubmit="return doRegister(this);">
                            <div class="form-group">
                                <input type="text" required name="name" required/>
                                <label class="control-label">Full Name</label>
                                <i class="mtrl-select"></i>
                            </div>

                            <div class="form-group">
                                 <input type="text" required name="username" required/>
                                 <label class="control-label">UserName</label>
                                 <i class="mtrl-select"></i>
                            </div>   
                            
                            <div class="form-group">
                                <input type="email" required name="email" required/>
                                <label class="control-label">Email</label>
                                <i class="mtrl-select"></i>
                           </div>
                           
                           <div class="form-group">
                            <input type="password" required name="password" required/>
                            <label class="control-label">Password</label>
                            <i class="mtrl-select"></i>
                       </div>
                        
                       <div class="form-radio">
                            <div class="radio">
                                <label>
                                    <input type="radio" name="gender" value="Male" checked />
                                    <i class="check-box"></i> Male
                                  </label>
                            </div>
                       </div>
                       <div class="form-radio">
                        <div class="radio">
                            <label>
                                <input type="radio" name="gender" value="Female" checked />
                                <i class="check-box"></i> Female
                              </label>
                        </div>
                    </div>

                    <div class="form-radio">
                        <div class="radio">
                            <label>
                                <input type="radio" name="gender" value="Other" checked />
                                <i class="check-box"></i> Other
                              </label>
                        </div>
                    </div>

                    <a href="/login">Already signed up?</a>
                    <div class="submit-btns">
                        <button class="mtr-btn register" name="submit" type="submit">
                            <span>Signup</span>
                        </button>
                    </div>

                    </form>
                </div>    
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Sign up funktionen -->
    <script>
        function doRegister(form) {
            form.submit.setAttribute ("disabled", "disabled");
            form.submit.innerHTML = "<span>Loading...</span>";

            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/signup", true);

            ajax.onreadystatechange = async function() {
                if (this.readyState == 4 && this.status == 200) {
                    form.submit.removeAttribute("disabled");
                    form.submit.innerHTML = "<span>Register</span>";

                    var response = JSON.parse(this.responseText);
                    alert(response.message);

                    console.log(response.status)

                    if (response.status == "success") {
                        
                    }
                    // beskeden der vises til brugeren n√•r de modtager mail
                /*window.location.href ="/verify-email";
                const msg = {
                    from: "Noreply@YaSite.com",
                    to: user.email,
                    subject: "YaSite - veryify your email.",
                    text: `
                    Hello, thanks for registering to our site.
                    Please copy and paste the link below to verify your account.
                    http://${req.headers.host}/verify-email?token=${user.emailToken}
                    `,
                    html:`
                    <h1>Hello!</h1>
                        <p>Thanks for registering on our site.</p>
                        <p>Please click the link below to verify your account.</p>
                        <a>http://${req.headers.host}/verify-email?token=${user.emailToken}</a>
                    `
                }*/
                // funktionen der sender email via grid og enten skriver sucess eller error
 /*               try {
                    await sgMail.send(msg);
                    req.flash("sucess", "thanks for registerings. please check your email to complete your verification.");
                    res.redirect('/');
                } catch(error) {
                    console.log(error);
                    req.flash("error", "something went wrong, pleace contact service@YaSite.com");
                    res.redirect('/');
                }*/
                }
            };
            ajax.send(new FormData(form));
            return false;

        }
    </script>
</body>

</html>